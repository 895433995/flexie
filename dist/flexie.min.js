var Flexie=function(x,E){function F(a){if(a)a=a.replace(wa,v).replace(xa,v);return a}function g(a,d){var c,b=0,e=a?a.length:W;if(e===W)for(c in a){if(a.hasOwnProperty(c))if(d.call(a[c],c,a[c])===I)break}else for(c=a[0];b<e&&d.call(c,b,c)!==I;c=a[++b]);}function ya(){var a;g(X,function(d,c){if(x[d]&&!a)if(a=eval(c.s.replace("*",d))){Y=d;return false}});return a}function Z(a,d){a="on"+a;var c=x[a];x[a]=typeof x[a]!=="function"?d:function(){c&&c();d()}}function $(a){var d=a.nodeName.toLowerCase();if(a.id)d+=
"#"+a.id;else if(a.FLX_DOM_ID)d+="["+aa+"='"+a.FLX_DOM_ID+"']";return d}function S(a){if(!a.FLX_DOM_ID){T+=1;a.FLX_DOM_ID=T;a.setAttribute(aa,a.FLX_DOM_ID)}}function za(a){var d=[],c,b,e,f,h,i;a=a.replace(Aa,v);a=a.replace(/\s?(\{|\:|\})\s?/g,P);a=a.split(ba);g(a,function(j,l){if(l){c=[l,ba].join(v);if((b=/(.*)\{(.*)\}/.exec(c))&&b[2]){e=b[1];f=b[2].split(";");i=[];g(f,function(m,r){h=r.split(":");h.length&&h[1]&&i.push({property:h[0],value:h[1]})});e&&i.length&&d.push({selector:e,properties:i})}}});
return d}function Ba(a){var d,c,b,e,f,h=/\s?,\s?/,i,j,l={},m={};i=function(r,n,o,k){var p={selector:F(r),properties:[]};g(n.properties,function(s,w){p.properties.push({property:F(w.property),value:F(w.value)})});if(o&&k)p[o]=k;return p};j=function(r,n,o,k){var p=o&&k?l[r]:m[r],s;if(p){g(n.properties,function(w,B){g(p.properties,function(L,A){if(B.property===A.property){s=L;return false}});if(s)p.properties[s]=B;else p.properties.push(B)});if(o&&k)p[o]=k}else if(o&&k)l[r]=i(r,n,o,k);else m[r]=i(r,
n,t,t)};g(a,function(r,n){d=F(n.selector).replace(h,",").split(h);g(d,function(o,k){k=F(k);c=n.properties;g(c,function(p,s){b=F(s.property);e=F(s.value);if(b){f=b.replace("box-",v);switch(f){case "display":e==="box"&&j(k,n,t,t);break;case "orient":case "align":case "direction":case "pack":j(k,n,t,t);break;case "flex":case "flex-group":case "ordinal-group":j(k,n,f,e)}}})})});g(m,function(r,n){y.push(n)});g(l,function(r,n){ca.push(n)});return{boxes:y,children:ca}}function da(a,d,c){var b,e,f=[];g(c,
function(h,i){if(i.selector){b=d(i.selector);b=b[0]?b:[b];b[0]&&g(b,function(j,l){switch(l.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(l.parentNode===a){S(l);e={};g(i,function(m){e[m]=i[m]});e.match=l;f.push(e)}}})}else{S(i);f.push({match:i,selector:$(i)})}});return f}function Ca(a){g(a,function(d,c){a[d]=c||Da[d]});return a}function Ea(a){var d,c,b,e,f,h,i,j,l,m,r,n,o,k,p={},s,w,B,L="["+Q+"]";if(a){g(a.boxes,function(A,C){C.selector=F(C.selector);d=C.selector;
c=C.properties;h=i=j=l=m=t;g(c,function(Fa,G){b=F(G.property);e=F(G.value);if(b){f=b.replace("box-",v);switch(f){case "display":if(e==="box")h=e;break;case "orient":i=e;break;case "align":j=e;break;case "direction":l=e;break;case "pack":m=e}}});r=J;n=r(C.selector);n=n[0]?n:[n];g(n,function(Fa,G){if(G.nodeType){S(G);o=da(G,r,a.children);B=d+" "+L;k={target:G,selector:d,properties:c,children:o,display:h,orient:i,align:j,direction:l,pack:m,nested:B};if(s=p[G.FLX_DOM_ID])g(k,function(K,M){switch(K){case "selector":if(M&&
!RegExp(M).test(s[K]))s[K]+=", "+M;break;case "children":g(k[K],function(Xa,ea){w=I;g(s[K],function(Ya,Ga){if(ea.match.FLX_DOM_ID===Ga.match.FLX_DOM_ID)w=q});w||s[K].push(ea)});break;default:if(M)s[K]=M}});else{p[G.FLX_DOM_ID]=Ca(k);p[G.FLX_DOM_ID].target.setAttribute(Q,q)}}})});fa=J(L);y={};g(fa,function(A,C){y[C.FLX_DOM_ID]=p[C.FLX_DOM_ID]});g(y,function(A,C){C.display==="box"&&new z.box(C)})}}function ga(a,d,c){c=c.replace(c.charAt(0),c.charAt(0).toUpperCase());var b=a["offset"+c]||0;b&&g(d,function(e,
f){f=parseFloat(a.currentStyle[f]);isNaN(f)||(b-=f)});return b}function ha(a,d){var c,b,e=a.currentStyle&&a.currentStyle[d],f=a.style;if(!ia.test(e)&&Ha.test(e)){c=f.left;b=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;f.left=e||0;e=f.pixelLeft+"px";f.left=c||0;a.runtimeStyle.left=b}return e}function u(a,d,c){if(x.getComputedStyle)a=x.getComputedStyle(a,t)[d];else if(Ia.test(d)){var b=a&&a.currentStyle?a.currentStyle[d]:0;if(!ia.test(b)){if(b==="auto"||b==="medium"){switch(d){case "width":b=
[ja,ka,la,ma];b=ga(a,b,d);break;case "height":b=[U,na,oa,pa];b=ga(a,b,d);break;default:b=ha(a,d)}a=b}else a=ha(a,d);b=a}a=b}else a=a.currentStyle[d];if(c){a=parseInt(a,10);if(isNaN(a))a=0}return a}function Ja(a){return a.innerWidth||a.clientWidth}function Ka(a){return a.innerHeight||a.clientHeight}function V(a,d,c,b){var e=[];g(La,function(f,h){e.push((b?h:v)+d+":"+(!b?h:v)+c)});a.style.cssText+=e.join(";");return a}function D(a,d,c){g(a&&a[0]?a:[a],function(b,e){if(e&&e.style)e.style[d]=c?c+"px":
v})}function Ma(a){var d,c;a=a.replace(Na,function(b,e){return"%"+e}).replace(/\s|\>|\+|\~/g,"%").split(/%/g);d={_id:100,_class:10,_tag:1};c=0;g(a,function(b,e){if(/#/.test(e))c+=d._id;else if(/\.|\[|\:/.test(e))c+=d._class;else if(/[a-zA-Z]+/.test(e))c+=d._tag});return c}function Oa(a,d,c){var b=[],e,f=(c?"ordinal":"flex")+"Specificity";g(a,function(h,i){if(!c&&i.flex||c&&i["ordinal-group"]){i[f]=i[f]||Ma(i.selector);e=I;g(b,function(j,l){if(l.match===i.match){if(l[f]<i[f])b[j]=i;e=q;return I}});
e||b.push(i)}});return b}function R(a,d,c){var b={},e=[],f=0,h;a=Oa(a,d,c);g(d,function(i,j){g(a,function(l,m){if(c){h=m["ordinal-group"]||"1";if(m.match===j){m.match.setAttribute("data-ordinal-group",h);b[h]=b[h]||[];b[h].push(m)}}else{h=m.flex||"0";if(m.match===j&&(!m[h]||m[h]&&parseInt(m[h],10)<=1)){f+=parseInt(h,10);b[h]=b[h]||[];b[h].push(m)}}});if(c&&!j.getAttribute("data-ordinal-group")){h="1";j.setAttribute("data-ordinal-group",h);b[h]=b[h]||[];b[h].push({match:j})}});g(b,function(i){e.push(i)});
e.sort(function(i,j){return j-i});return{keys:e,groups:b,total:f}}function qa(a,d,c){a=d.nodes;var b;for(b=function(e){return e.offsetTop-u(e,c.anti.pos,q)};b(a[0])!==b(a[a.length-1]);)g(a,function(e,f){if(!d.hasFlex||f.getAttribute("data-flex"))f.style[c.props.dim]=u(f,c.props.dim,q)-1})}function Pa(){if(!ra){var a,d,c,b,e=E.body,f=E.documentElement;Z("resize",function(){c=x.innerWidth||f.innerWidth||f.clientWidth||e.clientWidth;b=x.innerHeight||f.innerHeight||f.clientHeight||e.clientHeight;if(a!==
c||d!==b){z.updateInstance(t,t);a=c;d=b}});ra=q}}function sa(a){var d,c;g(a,function(b,e){d=e.style.width;c=e.style.height;e.style.cssText=v;e.style.width=d;e.style.height=c})}function N(a,d){var c=[],b,e,f;e=0;for(f=d.length;e<f;e++)if(b=d[e])switch(b.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(b.nodeType===1)c.push(b);else if(b.nodeType===3&&(b.isElementContentWhitespace||Qa.test(b.data))){a.removeChild(b);e--}}return c}function ta(a){var d=0;a=a.parentNode;for(var c;a.FLX_DOM_ID;){c=
y[a.FLX_DOM_ID];c=R(c.children,N(a,a.childNodes),t);d+=c.total;c=q;a=a.parentNode}return{nested:c,flex:d}}function Ra(a,d){var c=a.parentNode,b;if(c.FLX_DOM_ID){c=y[c.FLX_DOM_ID];g(c.properties,function(e,f){if(RegExp(d).test(f.property)){b=q;return I}})}return b}function Sa(a){a.flexMatrix&&g(a.children,function(d,c){c.flex=a.flexMatrix[d]});a.ordinalMatrix&&g(a.children,function(d,c){c["ordinal-group"]=a.ordinalMatrix[d]});return a}function Ta(a,d){var c=a.target;if(!c.FLX_DOM_ID)c.FLX_DOM_ID=c.FLX_DOM_ID||
++T;if(!a.nodes)a.nodes=N(c,c.childNodes);if(!a.selector){a.selector=$(c);c.setAttribute(Q,q)}if(!a.properties)a.properties=[];if(!a.children)a.children=da(c,J,N(c,c.childNodes));if(!a.nested)a.nested=a.selector+" ["+Q+"]";a.target=c;a._instance=d;return a}var z={},T=0,aa="data-flexie-id",Q="data-flexie-parent",H,Y,X={NW:{s:"*.Dom.select"},DOMAssistant:{s:"*.$",m:"*.DOMReady"},Prototype:{s:"$$",m:"document.observe",p:"dom:loaded",c:"document"},YAHOO:{s:"*.util.Selector.query",m:"*.util.Event.onDOMReady",
c:"*.util.Event"},MooTools:{s:"$$",m:"window.addEvent",p:"domready"},Sizzle:{s:"*"},jQuery:{s:"*",m:"*(document).ready"},dojo:{s:"*.query",m:"*.addOnLoad"}},J,ia=/^-?\d+(?:px)?$/i,Ha=/^-?\d/,Ia=/width|height|margin|padding|border/,Ua=/(msie) ([\w.]+)/,Aa=/\t|\n|\r/g,Va=/^max\-([a-z]+)/,Wa=/^https?:\/\//i,wa=/^\s\s*/,xa=/\s\s*$/,Qa=/^\s*$/,Na=/\s?(\#|\.|\[|\:(\:)?[^first\-(line|letter)|before|after]+)/g,v="",ua=" ",P="$1",ka="paddingRight",na="paddingBottom",ja="paddingLeft",U="paddingTop",ma="borderRightWidth",
pa="borderBottomWidth",la="borderLeftWidth",oa="borderTopWidth",ba="}",La=" -o- -moz- -ms- -webkit- -khtml- ".split(ua),Da={orient:"horizontal",align:"stretch",direction:"inherit",pack:"start"},y=[],ca=[],fa,ra,q=true,I=false,t=null,W,O={IE:function(){var a,d=Ua.exec(x.navigator.userAgent.toLowerCase());if(d)a=parseInt(d[2],10);return a}()},va;va=function(){function a(o){return o.replace(j,function(k,p,s){k=s.split(",");g(k,function(w,B){B.replace(l,P).replace(m,P).replace(n,P).replace(r,ua)});return p+
k.join(",")})}function d(){if(x.XMLHttpRequest)return new x.XMLHttpRequest;try{return new x.ActiveXObject("Microsoft.XMLHTTP")}catch(o){return t}}function c(o){var k=d();k.open("GET",o,I);k.send();return k.status===200?k.responseText:v}function b(o,k){if(o){if(Wa.test(o))return k.substring(0,k.indexOf("/",8))===o.substring(0,o.indexOf("/",8))?o:t;if(o.charAt(0)==="/")return k.substring(0,k.indexOf("/",8))+o;var p=k.split("?")[0];if(o.charAt(0)!=="?"&&p.charAt(p.length-1)!=="/")p=p.substring(0,p.lastIndexOf("/")+
1);return p+o}}function e(o){if(o)return c(o).replace(f,v).replace(h,function(k,p,s){return e(b(s,o))}).replace(i,function(k,p,s){p=p||v;return" url("+p+b(s,o)+p+") "});return v}var f=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g,h=/@import\s*(?:url\(\s*?)?(["'])?(.*?)\1\s*\)?[\w\W]*?;/g,i=/\surl\((["'])?([^"')]+)\1\)/g,j=/(^|\})\s*([^\{]*?[\[:][^\{]+)/g,l=/([(\[+~])\s+/g,m=/\s+([)\]+~])/g,r=/\s+/g,n=/^\s*((?:[\S\s]*\S)?)\s*$/;return function(){var o,k,p;k=E.getElementsByTagName("BASE");var s=k.length>0?
k[0].href:E.location.href,w;k=0;for(p=E.styleSheets.length;k<p;k++)if((o=E.styleSheets[k])&&o.href!==t)if(o=b(o.href,s)){w=a(e(o));w=za(w);w=Ba(w)}Ea(w)}}();z.box=function(a){return this.renderModel(a)};z.box.prototype={properties:{boxModel:function(a,d,c){var b,e;a.style.display="block";if(!c.cleared){selectors=c.selector.split(/\s?,\s?/);b=E.styleSheets;b=b[b.length-1];e="padding-top:"+(u(a,U,t)||"0.1px;");g(selectors,function(f,h){if(b.addRule)if(O.IE<8){a.style.zoom="1";if(O.IE===6)b.addRule(h.replace(/\>|\+|\~/g,
""),e+"zoom:1;",0);else O.IE===7&&b.addRule(h,e+"display:inline-block;",0)}else{b.addRule(h,e,0);b.addRule(h+":before","content: '.';display: block;height: 0;overflow: hidden",0);b.addRule(h+":after","content: '.';display: block;height: 0;overflow: hidden;clear:both;",0)}else if(b.insertRule){b.insertRule(h+"{"+e+"}",0);b.insertRule(h+":after{content: '.';display: block;height: 0;overflow: hidden;clear:both;}",0)}});c.cleared=q}},boxDirection:function(a,d,c){var b;if(c.direction==="reverse"&&!c.reversed||
c.direction==="normal"&&c.reversed){d=d.reverse();g(d,function(e,f){a.appendChild(f)});d=J(c.nested);g(d,function(e,f){if((b=y[f.FLX_DOM_ID])&&b.direction==="inherit")b.direction=c.direction});c.reversed=!c.reversed}},boxOrient:function(a,d,c){var b;a={pos:"marginLeft",opp:"marginRight",dim:"width",out:"offsetWidth",func:Ja,pad:[ja,ka,la,ma]};b={pos:"marginTop",opp:"marginBottom",dim:"height",out:"offsetHeight",func:Ka,pad:[U,na,oa,pa]};H||g(d,function(e,f){f.style[O.IE>=9?"cssFloat":"styleFloat"]=
"left";if(c.orient==="vertical"||c.orient==="block-axis")f.style.clear="left";if(O.IE===6)f.style.display="inline"});switch(c.orient){case "vertical":case "block-axis":this.props=b;this.anti=a;break;default:this.props=a;this.anti=b}},boxOrdinalGroup:function(a,d,c){var b,e;if(d.length){b=function(f){f=f.keys;g(c.reversed?f:f.reverse(),function(h,i){g(d,function(j,l){i===l.getAttribute("data-ordinal-group")&&a.appendChild(l)})})};e=R(c.children,d,q);e.keys.length>1&&b(e)}},boxFlex:function(a,d,c){var b=
this,e,f,h,i;if(d.length){e=function(j){var l=j.groups,m;g(j.keys,function(r,n){g(l[n],function(o,k){m=t;g(k.properties,function(p,s){if(Va.test(s.property))m=parseFloat(s.value)});if(!m||k.match[b.props.out]>m)D(k.match,b.props.pos,t)})})};f=function(j){var l=0,m;g(d,function(r,n){l+=u(n,b.props.dim,q);g(b.props.pad,function(o,k){l+=u(n,k,q)});l+=u(n,b.props.pos,q);l+=u(n,b.props.opp,q)});m=a[b.props.out]-l;g(b.props.pad,function(r,n){m-=u(a,n,q)});return{whitespace:m,ration:m/j.total}};h=function(j,
l){var m=j.groups,r,n,o=l.ration,k,p,s;g(j.keys,function(w,B){k=o*B;g(m[B],function(L,A){if(A.match){r=A.match.getAttribute("data-flex");n=A.match.getAttribute("data-specificity");if(!r||n<=A.flexSpecificity){A.match.setAttribute("data-flex",B);A.match.setAttribute("data-specificity",A.flexSpecificity);p=u(A.match,b.props.dim,q);s=Math.max(0,p+k);D(A.match,b.props.dim,s)}}})});if(c.orient==="horizontal"||c.orient==="inline-axis")qa(a,c,b)};i=R(c.children,d,t);if(i.total){c.hasFlex=q;e(i);e=f(i);h(i,
e)}}},boxAlign:function(a,d,c){var b=this,e,f,h=ta(a);if(!H&&!h.flex&&(c.orient==="vertical"||c.orient==="block-axis")){Ra(a,b.anti.dim)||D(a,b.anti.dim,t);D(d,b.anti.dim,t)}e=a[b.anti.out];g(b.anti.pad,function(i,j){e-=u(a,j,q)});switch(c.align){case "start":break;case "end":g(d,function(i,j){f=e-j[b.anti.out];f-=u(j,b.anti.opp,q);D(j,b.anti.pos,f)});break;case "center":g(d,function(i,j){f=(e-j[b.anti.out])/2;D(j,b.anti.pos,f)});break;default:g(d,function(i,j){switch(j.nodeName.toLowerCase()){case "button":case "input":case "select":break;
default:var l=0;g(b.anti.pad,function(m,r){l+=u(j,r,q);l+=u(a,r,q)});j.style[b.anti.dim]="100%";f=j[b.anti.out]-l;D(j,b.anti.dim,t);f=e;f-=u(j,b.anti.pos,q);g(b.anti.pad,function(m,r){f-=u(j,r,q)});f-=u(j,b.anti.opp,q);f=Math.max(0,f);D(j,b.anti.dim,f)}})}},boxPack:function(a,d,c){var b=this,e=0,f=0,h=0,i,j,l;l=d.length-1;g(d,function(r,n){e+=n[b.props.out];e+=u(n,b.props.pos,q);e+=u(n,b.props.opp,q)});f=u(d[0],b.props.pos,q);i=a[b.props.out]-e;g(b.props.pad,function(r,n){i-=u(a,n,q)});if(i<0)i=Math.max(0,
i);switch(c.pack){case "end":D(d[0],b.props.pos,h+f+i);break;case "center":if(h)h/=2;D(d[0],b.props.pos,h+f+i/2);break;case "justify":f=Math.floor((h+i)/l);l=f*l-i;for(var m=d.length-1;m;){h=d[m];j=f;if(l){j++;l++}j=u(h,b.props.pos,q)+j;D(h,b.props.pos,j);m--}}if((c.pack==="end"||c.pack==="justify")&&(c.orient==="horizontal"||c.orient==="inline-axis"))qa(a,c,b)}},setup:function(a,d,c){var b=this,e,f;if(!(!a||!d||!c))if(H&&H.partialSupport){e=R(c.children,d,t);f=ta(a);d=N(a,a.childNodes);b.properties.boxOrient.call(b,
a,d,c);if(!e.total||!J(c.nested).length){if(c.align==="stretch"&&!H.boxAlignStretch&&(!f.nested||!f.flex))b.properties.boxAlign.call(b,a,d,c);c.pack==="justify"&&!H.boxPackJustify&&!e.total&&b.properties.boxPack.call(b,a,d,c)}}else H||g(b.properties,function(h,i){i.call(b,a,N(a,a.childNodes),c)})},trackDOM:function(a){Pa(this,a)},updateModel:function(a){var d=a.target,c=a.nodes;sa(c);if(a.flexMatrix||a.ordinalMatrix)a=Sa(a);this.setup(d,c,a);this.bubbleUp(d,a)},renderModel:function(a){var d=this,
c=a.target,b=c.childNodes;if(!c.length&&!b)return false;a=Ta(a,this);d.updateModel(a);x.setTimeout(function(){d.trackDOM(a)},0);return d},bubbleUp:function(a,d){for(var c,b=d.target.parentNode;b;){if(c=y[b.FLX_DOM_ID]){sa(c.nodes);this.setup(c.target,c.nodes,c)}b=b.parentNode}}};z.updateInstance=function(a,d){var c;if(a)if(c=y[a.FLX_DOM_ID])c._instance.updateModel(c);else c=new z.box(d);else g(y,function(b,e){e._instance.updateModel(e)})};z.getInstance=function(a){return y[a.FLX_DOM_ID]};z.destroyInstance=
function(a){var d;d=function(c){c.target.FLX_DOM_ID=t;c.target.style.cssText=v;g(c.children,function(b,e){e.match.style.cssText=v})};if(a)(a=y[a.FLX_DOM_ID])&&d(a);else{g(y,function(c,b){d(b)});y=[]}};z.flexboxSupport=function(){var a={},d,c=E.createElement("flxbox"),b;c.style.width=c.style.height="100px";c.innerHTML='<b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b>';
V(c,"display","box",t);V(c,"box-align","stretch",q);V(c,"box-pack","justify",q);E.body.appendChild(c);d=c.firstChild.offsetHeight;g({boxAlignStretch:function(){return d===100},boxPackJustify:function(){var e=0;g(c.childNodes,function(f,h){e+=h.offsetLeft});return e===135}},function(e,f){b=f();if(!b)a.partialSupport=q;a[e]=b});E.body.removeChild(c);return~c.style.display.indexOf("box")?a:I};z.init=function(){z.flexboxSupported=H=z.flexboxSupport();if((!H||H.partialSupport)&&J)va()};z.version=0.9;(function(a){Y||
(J=ya());var d,c,b;g(X,function(e,f){if(x[e]&&!d&&f.m){d=eval(f.m.replace("*",e));c=f.c?eval(f.c.replace("*",e)):x;b=[];if(d&&c){f.p&&b.push(f.p);b.push(a);d.apply(c,b);return false}}});d||Z("load",a)})(z.init);return z}(this,document);
