var Flexie=function(z,E){function F(a){if(a)a=a.replace(va,u).replace(wa,u);return a}function h(a,d){var c,b=0,e=a?a.length:X;if(e===X)for(c in a){if(a.hasOwnProperty(c))if(d.call(a[c],c,a[c])===I)break}else for(c=a[0];b<e&&d.call(c,b,c)!==I;c=a[++b]);}function xa(){var a;h({NW:"*.Dom.select",DOMAssistant:"*.$",Prototype:"$$",YAHOO:"*.util.Selector.query",MooTools:"$$",Sizzle:"*",jQuery:"*",dojo:"*.query"},function(d,c){if(z[d]&&!a)if(a=eval(c.replace("*",d)))S=d});return a}function Y(a,d){a="on"+
a;var c=z[a];z[a]=typeof z[a]!=="function"?d:function(){c&&c();d()}}function Z(a){var d=a.nodeName.toLowerCase();if(a.id)d+="#"+a.id;else if(a.FLX_DOM_ID)d+="["+$+"='"+a.FLX_DOM_ID+"']";return d}function T(a){if(!a.FLX_DOM_ID){U+=1;a.FLX_DOM_ID=U;a.setAttribute($,a.FLX_DOM_ID)}}function ya(a){var d=[],c,b,e,f,g,i;a=a.replace(za,u);a=a.replace(/\s?(\{|\:|\})\s?/g,P);a=a.split(aa);h(a,function(j,l){if(l){c=[l,aa].join(u);if((b=/(.*)\{(.*)\}/.exec(c))&&b[2]){e=b[1];f=b[2].split(";");i=[];h(f,function(m,
r){g=r.split(":");g.length&&g[1]&&i.push({property:g[0],value:g[1]})});e&&i.length&&d.push({selector:e,properties:i})}}});return d}function Aa(a){var d,c,b,e,f,g=/\s?,\s?/,i,j,l={},m={};i=function(r,n,o,k){var p={selector:F(r),properties:[]};h(n.properties,function(s,v){p.properties.push({property:F(v.property),value:F(v.value)})});if(o&&k)p[o]=k;return p};j=function(r,n,o,k){var p=o&&k?l[r]:m[r],s;if(p){h(n.properties,function(v,A){h(p.properties,function(L,y){if(A.property===y.property){s=L;return false}});
if(s)p.properties[s]=A;else p.properties.push(A)});if(o&&k)p[o]=k}else if(o&&k)l[r]=i(r,n,o,k);else m[r]=i(r,n)};h(a,function(r,n){d=F(n.selector).replace(g,",").split(g);h(d,function(o,k){k=F(k);c=n.properties;h(c,function(p,s){b=F(s.property);e=F(s.value);if(b){f=b.replace("box-",u);switch(f){case "display":e==="box"&&j(k,n);break;case "orient":case "align":case "direction":case "pack":j(k,n);break;case "flex":case "flex-group":case "ordinal-group":j(k,n,f,e)}}})})});h(m,function(r,n){w.push(n)});
h(l,function(r,n){ba.push(n)});return{boxes:w,children:ba}}function ca(a,d,c){var b,e,f=[];h(c,function(g,i){if(i.selector){b=d(i.selector);b=b[0]?b:[b];b[0]&&h(b,function(j,l){switch(l.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(l.parentNode===a){T(l);e={};h(i,function(m){e[m]=i[m]});e.match=l;f.push(e)}}})}else{T(i);f.push({match:i,selector:Z(i)})}});return f}function Ba(a){h(a,function(d,c){a[d]=c||Ca[d]});return a}function Da(a){var d,c,b,e,f,g,i,j,l,m,r,n,
o,k,p={},s,v,A,L="["+Q+"]";if(a){h(a.boxes,function(y,C){C.selector=F(C.selector);d=C.selector;c=C.properties;g=i=j=l=m=B;h(c,function(Ea,G){b=F(G.property);e=F(G.value);if(b){f=b.replace("box-",u);switch(f){case "display":if(e==="box")g=e;break;case "orient":i=e;break;case "align":j=e;break;case "direction":l=e;break;case "pack":m=e}}});r=J;n=r(C.selector);n=n[0]?n:[n];h(n,function(Ea,G){if(G.nodeType){T(G);o=ca(G,r,a.children);A=d+" "+L;k={target:G,selector:d,properties:c,children:o,display:g,orient:i,
align:j,direction:l,pack:m,nested:A};if(s=p[G.FLX_DOM_ID])h(k,function(K,M){switch(K){case "selector":if(M&&!RegExp(M).test(s[K]))s[K]+=", "+M;break;case "children":h(k[K],function(Wa,da){v=I;h(s[K],function(Xa,Fa){if(da.match.FLX_DOM_ID===Fa.match.FLX_DOM_ID)v=q});v||s[K].push(da)});break;default:if(M)s[K]=M}});else{p[G.FLX_DOM_ID]=Ba(k);p[G.FLX_DOM_ID].target.setAttribute(Q,q)}}})});ea=J(L);w={};h(ea,function(y,C){w[C.FLX_DOM_ID]=p[C.FLX_DOM_ID]});h(w,function(y,C){C.display==="box"&&new x.box(C)})}}
function fa(a,d,c){c=c.replace(c.charAt(0),c.charAt(0).toUpperCase());var b=a["offset"+c]||0;b&&h(d,function(e,f){f=parseFloat(a.currentStyle[f]);isNaN(f)||(b-=f)});return b}function ga(a,d){var c,b,e=a.currentStyle&&a.currentStyle[d],f=a.style;if(!ha.test(e)&&Ga.test(e)){c=f.left;b=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;f.left=e||0;e=f.pixelLeft+"px";f.left=c||0;a.runtimeStyle.left=b}return e}function t(a,d,c){if(z.getComputedStyle)a=z.getComputedStyle(a,B)[d];else if(Ha.test(d)){var b=
a&&a.currentStyle?a.currentStyle[d]:0;if(!ha.test(b)){if(b==="auto"||b==="medium"){switch(d){case "width":b=[ia,ja,ka,la];b=fa(a,b,d);break;case "height":b=[V,ma,na,oa];b=fa(a,b,d);break;default:b=ga(a,d)}a=b}else a=ga(a,d);b=a}a=b}else a=a.currentStyle[d];if(c){a=parseInt(a,10);if(isNaN(a))a=0}return a}function Ia(a){return a.innerWidth||a.clientWidth}function Ja(a){return a.innerHeight||a.clientHeight}function W(a,d,c,b){var e=[];h(Ka,function(f,g){e.push((b?g:u)+d+":"+(!b?g:u)+c)});a.style.cssText+=
e.join(";");return a}function D(a,d,c){h(a&&a[0]?a:[a],function(b,e){if(e&&e.style)e.style[d]=c?c+"px":u})}function La(a,d){var c,b,e;c=a.replace(Ma,function(f,g){return"%"+g}).replace(/\s|\>|\+|\~/g,"%").split(/%/g);b={_id:100,_class:10,_tag:1};e=d||0;h(c,function(f,g){if(/#/.test(g))e+=b._id;else if(/\.|\[|\:/.test(g))e+=b._class;else if(/[a-zA-Z]+/.test(g))e+=b._tag});return e}function Na(a,d,c){var b=[],e,f=(c?"ordinal":"flex")+"Specificity";h(a,function(g,i){if(!c&&i.flex||c&&i["ordinal-group"]){i[f]=
i[f]||La(i.selector);e=I;h(b,function(j,l){if(l.match===i.match){if(l[f]<i[f])b[j]=i;e=q;return I}});e||b.push(i)}});return b}function R(a,d,c){var b={},e=[],f=0,g;a=Na(a,d,c);h(d,function(i,j){h(a,function(l,m){if(c){g=m["ordinal-group"]||"1";if(m.match===j){m.match.setAttribute("data-ordinal-group",g);b[g]=b[g]||[];b[g].push(m)}}else{g=m.flex||"0";if(m.match===j&&(!m[g]||m[g]&&parseInt(m[g],10)<=1)){f+=parseInt(g,10);b[g]=b[g]||[];b[g].push(m)}}});if(c&&!j.getAttribute("data-ordinal-group")){g=
"1";j.setAttribute("data-ordinal-group",g);b[g]=b[g]||[];b[g].push({match:j})}});h(b,function(i){e.push(i)});e.sort(function(i,j){return j-i});return{keys:e,groups:b,total:f}}function pa(a,d,c){a=d.nodes;var b;for(b=function(e){return e.offsetTop-t(e,c.anti.pos,q)};b(a[0])!==b(a[a.length-1]);)h(a,function(e,f){if(!d.hasFlex||f.getAttribute("data-flex"))f.style[c.props.dim]=t(f,c.props.dim,q)-1})}function Oa(){if(!qa){var a,d,c,b,e=E.body,f=E.documentElement;Y("resize",function(){c=z.innerWidth||f.innerWidth||
f.clientWidth||e.clientWidth;b=z.innerHeight||f.innerHeight||f.clientHeight||e.clientHeight;if(a!==c||d!==b){x.updateInstance();a=c;d=b}});qa=q}}function ra(a){var d,c;h(a,function(b,e){d=e.style.width;c=e.style.height;e.style.cssText=u;e.style.width=d;e.style.height=c})}function N(a,d){var c=[],b,e,f;e=0;for(f=d.length;e<f;e++)if(b=d[e])switch(b.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(b.nodeType===1)c.push(b);else if(b.nodeType===3&&(b.isElementContentWhitespace||
Pa.test(b.data))){a.removeChild(b);e--}}return c}function sa(a){var d=0;a=a.parentNode;for(var c;a.FLX_DOM_ID;){c=w[a.FLX_DOM_ID];c=R(c.children,N(a,a.childNodes));d+=c.total;c=q;a=a.parentNode}return{nested:c,flex:d}}function Qa(a,d){var c=a.parentNode,b;if(c.FLX_DOM_ID){c=w[c.FLX_DOM_ID];h(c.properties,function(e,f){if(RegExp(d).test(f.property)){b=q;return I}})}return b}function Ra(a){a.flexMatrix&&h(a.children,function(d,c){c.flex=a.flexMatrix[d]});a.ordinalMatrix&&h(a.children,function(d,c){c["ordinal-group"]=
a.ordinalMatrix[d]});return a}function Sa(a,d){var c=a.target;if(!c.FLX_DOM_ID)c.FLX_DOM_ID=c.FLX_DOM_ID||++U;if(!a.nodes)a.nodes=N(c,c.childNodes);if(!a.selector){a.selector=Z(c);c.setAttribute(Q,q)}if(!a.properties)a.properties=[];if(!a.children)a.children=ca(c,J,N(c,c.childNodes));if(!a.nested)a.nested=a.selector+" ["+Q+"]";a.target=c;a._instance=d;return a}var x={},U=0,$="data-flexie-id",Q="data-flexie-parent",H,S,J,ha=/^-?\d+(?:px)?$/i,Ga=/^-?\d/,Ha=/width|height|margin|padding|border/,Ta=/(msie) ([\w.]+)/,
za=/\t|\n|\r/g,Ua=/^max\-([a-z]+)/,Va=/^https?:\/\//i,va=/^\s\s*/,wa=/\s\s*$/,Pa=/^\s*$/,Ma=/\s?(\#|\.|\[|\:(\:)?[^first\-(line|letter)|before|after]+)/g,u="",ta=" ",P="$1",ja="paddingRight",ma="paddingBottom",ia="paddingLeft",V="paddingTop",la="borderRightWidth",oa="borderBottomWidth",ka="borderLeftWidth",na="borderTopWidth",aa="}",Ka=" -o- -moz- -ms- -webkit- -khtml- ".split(ta),Ca={orient:"horizontal",align:"stretch",direction:"inherit",pack:"start"},w=[],ba=[],ea,qa,q=true,I=false,B=null,X,O=
{IE:function(){var a,d=Ta.exec(z.navigator.userAgent.toLowerCase());if(d)a=parseInt(d[2],10);return a}()},ua;ua=function(){function a(o){return o.replace(j,function(k,p,s){k=s.split(",");h(k,function(v,A){A.replace(l,P).replace(m,P).replace(n,P).replace(r,ta)});return p+k.join(",")})}function d(){if(z.XMLHttpRequest)return new z.XMLHttpRequest;try{return new z.ActiveXObject("Microsoft.XMLHTTP")}catch(o){return B}}function c(o){var k=d();k.open("GET",o,I);k.send();return k.status===200?k.responseText:
u}function b(o,k){if(o){if(Va.test(o))return k.substring(0,k.indexOf("/",8))===o.substring(0,o.indexOf("/",8))?o:B;if(o.charAt(0)==="/")return k.substring(0,k.indexOf("/",8))+o;var p=k.split("?")[0];if(o.charAt(0)!=="?"&&p.charAt(p.length-1)!=="/")p=p.substring(0,p.lastIndexOf("/")+1);return p+o}}function e(o){if(o)return c(o).replace(f,u).replace(g,function(k,p,s){return e(b(s,o))}).replace(i,function(k,p,s){p=p||u;return" url("+p+b(s,o)+p+") "});return u}var f=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g,
g=/@import\s*(?:url\(\s*?)?(["'])?(.*?)\1\s*\)?[\w\W]*?;/g,i=/\surl\((["'])?([^"')]+)\1\)/g,j=/(^|\})\s*([^\{]*?[\[:][^\{]+)/g,l=/([(\[+~])\s+/g,m=/\s+([)\]+~])/g,r=/\s+/g,n=/^\s*((?:[\S\s]*\S)?)\s*$/;return function(){var o,k,p;k=E.getElementsByTagName("BASE");var s=k.length>0?k[0].href:E.location.href,v;k=0;for(p=E.styleSheets.length;k<p;k++)if((o=E.styleSheets[k])&&o.href!==B)if(o=b(o.href,s)){v=a(e(o));v=ya(v);v=Aa(v)}Da(v)}}();x.box=function(a){this.renderModel(a)};x.box.prototype={properties:{boxModel:function(a,
d,c){var b,e;a.style.display="block";if(!c.cleared){selectors=c.selector.split(/\s?,\s?/);b=E.styleSheets;b=b[b.length-1];e="padding-top:"+(t(a,V,B)||"0.1px;");h(selectors,function(f,g){if(b.addRule)if(O.IE<8){a.style.zoom="1";if(O.IE===6)b.addRule(g.replace(/\>|\+|\~/g,""),e+"zoom:1;",0);else O.IE===7&&b.addRule(g,e+"display:inline-block;",0)}else{b.addRule(g,e,0);b.addRule(g+":after","content:'\u00020';display:block;margin:0;padding:0;border:0;width:0;height:1px;background:none;clear:both;font-size:0;visibility:hidden",
0)}else if(b.insertRule){b.insertRule(g+"{"+e+"}",0);b.insertRule(g+":after{content:'\u00020';display:block;margin:0;padding:0;border:0;width:0;height:1px;background:none;clear:both;font-size:0;visibility:hidden}",0)}});c.cleared=q}},boxDirection:function(a,d,c){var b;if(c.direction==="reverse"&&!c.reversed||c.direction==="normal"&&c.reversed){d=d.reverse();h(d,function(e,f){a.appendChild(f)});d=J(c.nested);h(d,function(e,f){if((b=w[f.FLX_DOM_ID])&&b.direction==="inherit")b.direction=c.direction});
c.reversed=!c.reversed}},boxOrient:function(a,d,c){var b;a={pos:"marginLeft",opp:"marginRight",dim:"width",out:"offsetWidth",func:Ia,pad:[ia,ja,ka,la]};b={pos:"marginTop",opp:"marginBottom",dim:"height",out:"offsetHeight",func:Ja,pad:[V,ma,na,oa]};H||h(d,function(e,f){f.style[O.IE>=9?"cssFloat":"styleFloat"]="left";if(c.orient==="vertical")f.style.clear="left";if(O.IE===6)f.style.display="inline"});switch(c.orient){case "vertical":case "block-axis":this.props=b;this.anti=a;break;default:this.props=
a;this.anti=b}},boxOrdinalGroup:function(a,d,c){var b,e;if(d.length){b=function(f){f=f.keys;h(c.reversed?f:f.reverse(),function(g,i){h(d,function(j,l){i===l.getAttribute("data-ordinal-group")&&a.appendChild(l)})})};e=R(c.children,d,q);e.keys.length>1&&b(e)}},boxFlex:function(a,d,c){var b=this,e,f,g,i;if(d.length){e=function(j){var l=j.groups,m;h(j.keys,function(r,n){h(l[n],function(o,k){m=B;h(k.properties,function(p,s){if(Ua.test(s.property))m=parseFloat(s.value)});if(!m||k.match[b.props.out]>m)D(k.match,
b.props.pos,B)})})};f=function(j){var l=0,m;h(d,function(r,n){l+=t(n,b.props.dim,q);h(b.props.pad,function(o,k){l+=t(n,k,q)});l+=t(n,b.props.pos,q);l+=t(n,b.props.opp,q)});m=a[b.props.out]-l;h(b.props.pad,function(r,n){m-=t(a,n,q)});return{whitespace:m,ration:m/j.total}};g=function(j,l){var m=j.groups,r,n,o=l.ration,k,p,s;h(j.keys,function(v,A){k=o*A;h(m[A],function(L,y){if(y.match){r=y.match.getAttribute("data-flex");n=y.match.getAttribute("data-specificity");if(!r||n<=y.flexSpecificity){y.match.setAttribute("data-flex",
A);y.match.setAttribute("data-specificity",y.flexSpecificity);p=t(y.match,b.props.dim,q);s=Math.max(0,p+k);D(y.match,b.props.dim,s)}}})});c.orient==="horizontal"&&pa(a,c,b)};i=R(c.children,d);if(i.total){c.hasFlex=q;e(i);e=f(i);g(i,e)}}},boxAlign:function(a,d,c){var b=this,e,f,g=sa(a);if(!H&&!g.flex&&c.orient==="vertical"){Qa(a,b.anti.dim)||D(a,b.anti.dim,B);D(d,b.anti.dim,B)}e=a[b.anti.out];h(b.anti.pad,function(i,j){e-=t(a,j,q)});switch(c.align){case "start":break;case "end":h(d,function(i,j){f=
e-j[b.anti.out];f-=t(j,b.anti.opp,q);D(j,b.anti.pos,f)});break;case "center":h(d,function(i,j){f=(e-j[b.anti.out])/2;D(j,b.anti.pos,f)});break;default:h(d,function(i,j){switch(j.nodeName.toLowerCase()){case "button":case "input":case "select":break;default:var l=0;h(b.anti.pad,function(m,r){l+=t(j,r,q);l+=t(a,r,q)});j.style[b.anti.dim]="100%";f=j[b.anti.out]-l;D(j,b.anti.dim,B);f=e;f-=t(j,b.anti.pos,q);h(b.anti.pad,function(m,r){f-=t(j,r,q)});f-=t(j,b.anti.opp,q);f=Math.max(0,f);D(j,b.anti.dim,f)}})}},
boxPack:function(a,d,c){var b=this,e=0,f=0,g=0,i,j,l;l=d.length-1;h(d,function(r,n){e+=n[b.props.out];e+=t(n,b.props.pos,q);e+=t(n,b.props.opp,q)});f=t(d[0],b.props.pos,q);i=a[b.props.out]-e;h(b.props.pad,function(r,n){i-=t(a,n,q)});if(i<0)i=Math.max(0,i);switch(c.pack){case "end":D(d[0],b.props.pos,g+f+i);break;case "center":if(g)g/=2;D(d[0],b.props.pos,g+f+i/2);break;case "justify":f=Math.floor((g+i)/l);l=f*l-i;for(var m=d.length-1;m;){g=d[m];j=f;if(l){j++;l++}j=t(g,b.props.pos,q)+j;D(g,b.props.pos,
j);m--}}if((c.pack==="end"||c.pack==="justify")&&c.orient==="horizontal")pa(a,c,b)}},setup:function(a,d,c){var b=this,e,f;if(!(!a||!d||!c))if(H&&H.partialSupport){e=R(c.children,d);f=sa(a);d=N(a,a.childNodes);b.properties.boxOrient.call(b,a,d,c);if((!e.total||!J(c.nested).length)&&(!f.nested||!f.flex)){c.align==="stretch"&&!H.boxAlignStretch&&b.properties.boxAlign.call(b,a,d,c);c.pack==="justify"&&!H.boxPackJustify&&b.properties.boxPack.call(b,a,d,c)}}else H||h(b.properties,function(g,i){i.call(b,
a,N(a,a.childNodes),c)})},trackDOM:function(a){Oa(this,a)},updateModel:function(a){var d=a.target,c=a.nodes;ra(c);if(a.flexMatrix||a.ordinalMatrix)a=Ra(a);this.setup(d,c,a);this.bubbleUp(d,a)},renderModel:function(a){var d=this,c=a.target,b=c.childNodes;if(c.length||b){a=Sa(a,this);d.updateModel(a);z.setTimeout(function(){d.trackDOM(a)},0)}},bubbleUp:function(a,d){for(var c,b=d.target.parentNode;b;){if(c=w[b.FLX_DOM_ID]){ra(c.nodes);this.setup(c.target,c.nodes,c)}b=b.parentNode}}};x.updateInstance=
function(a,d){var c;if(a)if(c=w[a.FLX_DOM_ID])c._instance.updateModel(c);else c=new x.box(d);else h(w,function(b,e){e._instance.updateModel(e)})};x.getInstance=function(a){return w[a.FLX_DOM_ID]};x.destroyInstance=function(a){var d;d=function(c){c.target.FLX_DOM_ID=B;c.target.style.cssText=u;h(c.children,function(b,e){e.match.style.cssText=u})};if(a)(a=w[a.FLX_DOM_ID])&&d(a);else{h(w,function(c,b){d(b)});w=[]}};x.flexboxSupport=function(){var a={},d,c=E.createElement("flxbox"),b;c.style.width=c.style.height=
"100px";c.innerHTML='<b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b>';W(c,"display","box");W(c,"box-align","stretch",q);W(c,"box-pack","justify",q);E.body.appendChild(c);d=c.firstChild.offsetHeight;h({boxAlignStretch:function(){return d===100},boxPackJustify:function(){var e=0;h(c.childNodes,function(f,g){e+=g.offsetLeft});
return e===135}},function(e,f){b=f();if(!b)a.partialSupport=q;a[e]=b});E.body.removeChild(c);return~c.style.display.indexOf("box")?a:I};x.init=function(){x.flexboxSupported=H=x.flexboxSupport();J=xa();if((!H||H.partialSupport)&&J)ua()};x.version=0.9;(function(a){var d,c;if((c={DOMAssistant:["*.DOMReady","%"],Prototype:["document.observe","'dom:loaded', %"],YAHOO:["*.util.Event","onDOMReady","%"],MooTools:["window.addEvent","'domready', %"],jQuery:["*(document).ready","%"],dojo:["*.addOnLoad","%"]}[S])&&
!d){if((d=eval(c[0].replace("*",S)))&&c[2])d=d[c[1]];try{eval(d+"("+c[c.length-1].replace("%",a)+")")}catch(b){}}Y("load",function(){!d&&a&&a()})})(x.init);return x}(this,document);
