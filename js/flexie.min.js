var Flexie=function(A,E){function F(a){if(a)a=a.replace(va,v).replace(wa,v);return a}function h(a,d){var b,c=0,e=a?a.length:X;if(e===X)for(b in a){if(a.hasOwnProperty(b))if(d.call(a[b],b,a[b])===I)break}else for(b=a[0];c<e&&d.call(b,c,b)!==I;b=a[++c]);}function xa(){var a;h({NW:"*.Dom.select",DOMAssistant:"*.$",Prototype:"$$",YAHOO:"*.util.Selector.query",MooTools:"$$",Sizzle:"*",jQuery:"*",dojo:"*.query"},function(d,b){if(A[d]&&!a)if(a=eval(b.replace("*",d)))S=d});return a}function Y(a,d){a="on"+
a;var b=A[a];A[a]=typeof A[a]!=="function"?d:function(){b&&b();d()}}function Z(a){var d=a.nodeName.toLowerCase();if(a.id)d+="#"+a.id;else if(a.FLX_DOM_ID)d+="["+$+"='"+a.FLX_DOM_ID+"']";return d}function T(a){if(!a.FLX_DOM_ID){U+=1;a.FLX_DOM_ID=U;a.setAttribute($,a.FLX_DOM_ID)}}function ya(a){var d=[],b,c,e,f,i,g;a=a.replace(za,v);a=a.replace(/\s?(\{|\:|\})\s?/g,P);a=a.split(aa);h(a,function(j,l){if(l){b=[l,aa].join(v);if((c=/(.*)\{(.*)\}/.exec(b))&&c[2]){e=c[1];f=c[2].split(";");g=[];h(f,function(m,
r){i=r.split(":");i.length&&i[1]&&g.push({property:i[0],value:i[1]})});e&&g.length&&d.push({selector:e,properties:g})}}});return d}function Aa(a){var d,b,c,e,f,i=/\s?,\s?/,g,j,l={},m={};g=function(r,n,o,k){var p={selector:F(r),properties:[]};h(n.properties,function(s,w){p.properties.push({property:F(w.property),value:F(w.value)})});if(o&&k)p[o]=k;return p};j=function(r,n,o,k){var p=o&&k?l[r]:m[r],s;if(p){h(n.properties,function(w,B){h(p.properties,function(M,z){if(B.property===z.property){s=M;return false}});
if(s)p.properties[s]=B;else p.properties.push(B)});if(o&&k)p[o]=k}else if(o&&k)l[r]=g(r,n,o,k);else m[r]=g(r,n,t,t)};h(a,function(r,n){d=F(n.selector).replace(i,",").split(i);h(d,function(o,k){k=F(k);b=n.properties;h(b,function(p,s){c=F(s.property);e=F(s.value);if(c){f=c.replace("box-",v);switch(f){case "display":e==="box"&&j(k,n,t,t);break;case "orient":case "align":case "direction":case "pack":j(k,n,t,t);break;case "flex":case "flex-group":case "ordinal-group":j(k,n,f,e)}}})})});h(m,function(r,
n){x.push(n)});h(l,function(r,n){ba.push(n)});return{boxes:x,children:ba}}function ca(a,d,b){var c,e,f=[];h(b,function(i,g){if(g.selector){c=d(g.selector);c=c[0]?c:[c];c[0]&&h(c,function(j,l){switch(l.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(l.parentNode===a){T(l);e={};h(g,function(m){e[m]=g[m]});e.match=l;f.push(e)}}})}else{T(g);f.push({match:g,selector:Z(g)})}});return f}function Ba(a){h(a,function(d,b){a[d]=b||Ca[d]});return a}function Da(a){var d,b,c,e,f,
i,g,j,l,m,r,n,o,k,p={},s,w,B,M="["+Q+"]";if(a){h(a.boxes,function(z,C){C.selector=F(C.selector);d=C.selector;b=C.properties;i=g=j=l=m=t;h(b,function(Ea,G){c=F(G.property);e=F(G.value);if(c){f=c.replace("box-",v);switch(f){case "display":if(e==="box")i=e;break;case "orient":g=e;break;case "align":j=e;break;case "direction":l=e;break;case "pack":m=e}}});r=J;n=r(C.selector);n=n[0]?n:[n];h(n,function(Ea,G){if(G.nodeType){T(G);o=ca(G,r,a.children);B=d+" "+M;k={target:G,selector:d,properties:b,children:o,
display:i,orient:g,align:j,direction:l,pack:m,nested:B};if(s=p[G.FLX_DOM_ID])h(k,function(K,N){switch(K){case "selector":if(N&&!RegExp(N).test(s[K]))s[K]+=", "+N;break;case "children":h(k[K],function(Wa,da){w=I;h(s[K],function(Xa,Fa){if(da.match.FLX_DOM_ID===Fa.match.FLX_DOM_ID)w=q});w||s[K].push(da)});break;default:if(N)s[K]=N}});else{p[G.FLX_DOM_ID]=Ba(k);p[G.FLX_DOM_ID].target.setAttribute(Q,q)}}})});ea=J(M);x={};h(ea,function(z,C){x[C.FLX_DOM_ID]=p[C.FLX_DOM_ID]});h(x,function(z,C){C.display===
"box"&&new y.box(C)})}}function fa(a,d,b){b=b.replace(b.charAt(0),b.charAt(0).toUpperCase());var c=a["offset"+b]||0;c&&h(d,function(e,f){f=parseFloat(a.currentStyle[f]);isNaN(f)||(c-=f)});return c}function ga(a,d){var b,c,e=a.currentStyle&&a.currentStyle[d],f=a.style;if(!ha.test(e)&&Ga.test(e)){b=f.left;c=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;f.left=e||0;e=f.pixelLeft+"px";f.left=b||0;a.runtimeStyle.left=c}return e}function u(a,d,b){if(A.getComputedStyle)a=A.getComputedStyle(a,
t)[d];else if(Ha.test(d)){var c=a&&a.currentStyle?a.currentStyle[d]:0;if(!ha.test(c)){if(c==="auto"||c==="medium"){switch(d){case "width":c=[ia,ja,ka,la];c=fa(a,c,d);break;case "height":c=[V,ma,na,oa];c=fa(a,c,d);break;default:c=ga(a,d)}a=c}else a=ga(a,d);c=a}a=c}else a=a.currentStyle[d];if(b){a=parseInt(a,10);if(isNaN(a))a=0}return a}function Ia(a){return a.innerWidth||a.clientWidth}function Ja(a){return a.innerHeight||a.clientHeight}function W(a,d,b,c){var e=[];h(Ka,function(f,i){e.push((c?i:v)+
d+":"+(!c?i:v)+b)});a.style.cssText+=e.join(";");return a}function D(a,d,b){h(a&&a[0]?a:[a],function(c,e){if(e&&e.style)e.style[d]=b?b+"px":v})}function La(a){var d,b;a=a.replace(Ma,function(c,e){return"%"+e}).replace(/\s|\>|\+|\~/g,"%").split(/%/g);d={_id:100,_class:10,_tag:1};b=0;h(a,function(c,e){if(/#/.test(e))b+=d._id;else if(/\.|\[|\:/.test(e))b+=d._class;else if(/[a-zA-Z]+/.test(e))b+=d._tag});return b}function Na(a,d,b){var c=[],e,f=(b?"ordinal":"flex")+"Specificity";h(a,function(i,g){if(!b&&
g.flex||b&&g["ordinal-group"]){g[f]=g[f]||La(g.selector);e=I;h(c,function(j,l){if(l.match===g.match){if(l[f]<g[f])c[j]=g;e=q;return I}});e||c.push(g)}});return c}function R(a,d,b){var c={},e=[],f=0,i;a=Na(a,d,b);h(d,function(g,j){h(a,function(l,m){if(b){i=m["ordinal-group"]||"1";if(m.match===j){m.match.setAttribute("data-ordinal-group",i);c[i]=c[i]||[];c[i].push(m)}}else{i=m.flex||"0";if(m.match===j&&(!m[i]||m[i]&&parseInt(m[i],10)<=1)){f+=parseInt(i,10);c[i]=c[i]||[];c[i].push(m)}}});if(b&&!j.getAttribute("data-ordinal-group")){i=
"1";j.setAttribute("data-ordinal-group",i);c[i]=c[i]||[];c[i].push({match:j})}});h(c,function(g){e.push(g)});e.sort(function(g,j){return j-g});return{keys:e,groups:c,total:f}}function pa(a,d,b){a=d.nodes;var c;for(c=function(e){return e.offsetTop-u(e,b.anti.pos,q)};c(a[0])!==c(a[a.length-1]);)h(a,function(e,f){if(!d.hasFlex||f.getAttribute("data-flex"))f.style[b.props.dim]=u(f,b.props.dim,q)-1})}function Oa(){if(!qa){var a,d,b,c,e=E.body,f=E.documentElement;Y("resize",function(){b=A.innerWidth||f.innerWidth||
f.clientWidth||e.clientWidth;c=A.innerHeight||f.innerHeight||f.clientHeight||e.clientHeight;if(a!==b||d!==c){y.updateInstance(t,t);a=b;d=c}});qa=q}}function ra(a){var d,b;h(a,function(c,e){d=e.style.width;b=e.style.height;e.style.cssText=v;e.style.width=d;e.style.height=b})}function O(a,d){var b=[],c,e,f;e=0;for(f=d.length;e<f;e++)if(c=d[e])switch(c.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(c.nodeType===1)b.push(c);else if(c.nodeType===3&&(c.isElementContentWhitespace||
Pa.test(c.data))){a.removeChild(c);e--}}return b}function sa(a){var d=0;a=a.parentNode;for(var b;a.FLX_DOM_ID;){b=x[a.FLX_DOM_ID];b=R(b.children,O(a,a.childNodes),t);d+=b.total;b=q;a=a.parentNode}return{nested:b,flex:d}}function Qa(a,d){var b=a.parentNode,c;if(b.FLX_DOM_ID){b=x[b.FLX_DOM_ID];h(b.properties,function(e,f){if(RegExp(d).test(f.property)){c=q;return I}})}return c}function Ra(a){a.flexMatrix&&h(a.children,function(d,b){b.flex=a.flexMatrix[d]});a.ordinalMatrix&&h(a.children,function(d,b){b["ordinal-group"]=
a.ordinalMatrix[d]});return a}function Sa(a,d){var b=a.target;if(!b.FLX_DOM_ID)b.FLX_DOM_ID=b.FLX_DOM_ID||++U;if(!a.nodes)a.nodes=O(b,b.childNodes);if(!a.selector){a.selector=Z(b);b.setAttribute(Q,q)}if(!a.properties)a.properties=[];if(!a.children)a.children=ca(b,J,O(b,b.childNodes));if(!a.nested)a.nested=a.selector+" ["+Q+"]";a.target=b;a._instance=d;return a}var y={},U=0,$="data-flexie-id",Q="data-flexie-parent",H,S,J,ha=/^-?\d+(?:px)?$/i,Ga=/^-?\d/,Ha=/width|height|margin|padding|border/,Ta=/(msie) ([\w.]+)/,
za=/\t|\n|\r/g,Ua=/^max\-([a-z]+)/,Va=/^https?:\/\//i,va=/^\s\s*/,wa=/\s\s*$/,Pa=/^\s*$/,Ma=/\s?(\#|\.|\[|\:(\:)?[^first\-(line|letter)|before|after]+)/g,v="",ta=" ",P="$1",ja="paddingRight",ma="paddingBottom",ia="paddingLeft",V="paddingTop",la="borderRightWidth",oa="borderBottomWidth",ka="borderLeftWidth",na="borderTopWidth",aa="}",Ka=" -o- -moz- -ms- -webkit- -khtml- ".split(ta),Ca={orient:"horizontal",align:"stretch",direction:"inherit",pack:"start"},x=[],ba=[],ea,qa,q=true,I=false,t=null,X,L=
{IE:function(){var a,d=Ta.exec(A.navigator.userAgent.toLowerCase());if(d)a=parseInt(d[2],10);return a}()},ua;ua=function(){function a(o){return o.replace(j,function(k,p,s){k=s.split(",");h(k,function(w,B){B.replace(l,P).replace(m,P).replace(n,P).replace(r,ta)});return p+k.join(",")})}function d(){if(A.XMLHttpRequest)return new A.XMLHttpRequest;try{return new A.ActiveXObject("Microsoft.XMLHTTP")}catch(o){return t}}function b(o){var k=d();k.open("GET",o,I);k.send();return k.status===200?k.responseText:
v}function c(o,k){if(o){if(Va.test(o))return k.substring(0,k.indexOf("/",8))===o.substring(0,o.indexOf("/",8))?o:t;if(o.charAt(0)==="/")return k.substring(0,k.indexOf("/",8))+o;var p=k.split("?")[0];if(o.charAt(0)!=="?"&&p.charAt(p.length-1)!=="/")p=p.substring(0,p.lastIndexOf("/")+1);return p+o}}function e(o){if(o)return b(o).replace(f,v).replace(i,function(k,p,s){return e(c(s,o))}).replace(g,function(k,p,s){p=p||v;return" url("+p+c(s,o)+p+") "});return v}var f=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g,
i=/@import\s*(?:url\(\s*?)?(["'])?(.*?)\1\s*\)?[\w\W]*?;/g,g=/\surl\((["'])?([^"')]+)\1\)/g,j=/(^|\})\s*([^\{]*?[\[:][^\{]+)/g,l=/([(\[+~])\s+/g,m=/\s+([)\]+~])/g,r=/\s+/g,n=/^\s*((?:[\S\s]*\S)?)\s*$/;return function(){var o,k,p;k=E.getElementsByTagName("BASE");var s=k.length>0?k[0].href:E.location.href,w;k=0;for(p=E.styleSheets.length;k<p;k++)if((o=E.styleSheets[k])&&o.href!==t)if(o=c(o.href,s)){w=a(e(o));w=ya(w);w=Aa(w)}Da(w)}}();y.box=function(a){return this.renderModel(a)};y.box.prototype={properties:{boxModel:function(a,
d,b){var c,e,f;a.style.display="block";if(!b.cleared){selectors=b.selector.split(/\s?,\s?/);c=E.styleSheets;c=c[c.length-1];e="padding-top:"+(u(a,V,t)||"0.1px;");f=["content:' ';display:block;margin:0;padding:0;border:0","width:"+(L.IE?"0":"auto"),"height:"+(L.IE?"1px":"0"),"background:none;clear:both;font-size:0;visibility:hidden"].join(";");h(selectors,function(i,g){if(c.addRule)if(L.IE<8){a.style.zoom="1";if(L.IE===6)c.addRule(g.replace(/\>|\+|\~/g,""),e+"zoom:1;",0);else L.IE===7&&c.addRule(g,
e+"display:inline-block;",0)}else{c.addRule(g,e,0);c.addRule(g+":after",f,0)}else if(c.insertRule){c.insertRule(g+"{"+e+"}",0);c.insertRule(g+":after{"+f+"}",0)}});b.cleared=q}},boxDirection:function(a,d,b){var c;if(b.direction==="reverse"&&!b.reversed||b.direction==="normal"&&b.reversed){d=d.reverse();h(d,function(e,f){a.appendChild(f)});d=J(b.nested);h(d,function(e,f){if((c=x[f.FLX_DOM_ID])&&c.direction==="inherit")c.direction=b.direction});b.reversed=!b.reversed}},boxOrient:function(a,d,b){var c;
a={pos:"marginLeft",opp:"marginRight",dim:"width",out:"offsetWidth",func:Ia,pad:[ia,ja,ka,la]};c={pos:"marginTop",opp:"marginBottom",dim:"height",out:"offsetHeight",func:Ja,pad:[V,ma,na,oa]};H||h(d,function(e,f){f.style[L.IE>=9?"cssFloat":"styleFloat"]="left";if(b.orient==="vertical")f.style.clear="left";if(L.IE===6)f.style.display="inline"});switch(b.orient){case "vertical":case "block-axis":this.props=c;this.anti=a;break;default:this.props=a;this.anti=c}},boxOrdinalGroup:function(a,d,b){var c,e;
if(d.length){c=function(f){f=f.keys;h(b.reversed?f:f.reverse(),function(i,g){h(d,function(j,l){g===l.getAttribute("data-ordinal-group")&&a.appendChild(l)})})};e=R(b.children,d,q);e.keys.length>1&&c(e)}},boxFlex:function(a,d,b){var c=this,e,f,i,g;if(d.length){e=function(j){var l=j.groups,m;h(j.keys,function(r,n){h(l[n],function(o,k){m=t;h(k.properties,function(p,s){if(Ua.test(s.property))m=parseFloat(s.value)});if(!m||k.match[c.props.out]>m)D(k.match,c.props.pos,t)})})};f=function(j){var l=0,m;h(d,
function(r,n){l+=u(n,c.props.dim,q);h(c.props.pad,function(o,k){l+=u(n,k,q)});l+=u(n,c.props.pos,q);l+=u(n,c.props.opp,q)});m=a[c.props.out]-l;h(c.props.pad,function(r,n){m-=u(a,n,q)});return{whitespace:m,ration:m/j.total}};i=function(j,l){var m=j.groups,r,n,o=l.ration,k,p,s;h(j.keys,function(w,B){k=o*B;h(m[B],function(M,z){if(z.match){r=z.match.getAttribute("data-flex");n=z.match.getAttribute("data-specificity");if(!r||n<=z.flexSpecificity){z.match.setAttribute("data-flex",B);z.match.setAttribute("data-specificity",
z.flexSpecificity);p=u(z.match,c.props.dim,q);s=Math.max(0,p+k);D(z.match,c.props.dim,s)}}})});b.orient==="horizontal"&&pa(a,b,c)};g=R(b.children,d,t);if(g.total){b.hasFlex=q;e(g);e=f(g);i(g,e)}}},boxAlign:function(a,d,b){var c=this,e,f,i=sa(a);if(!H&&!i.flex&&b.orient==="vertical"){Qa(a,c.anti.dim)||D(a,c.anti.dim,t);D(d,c.anti.dim,t)}e=a[c.anti.out];h(c.anti.pad,function(g,j){e-=u(a,j,q)});switch(b.align){case "start":break;case "end":h(d,function(g,j){f=e-j[c.anti.out];f-=u(j,c.anti.opp,q);D(j,
c.anti.pos,f)});break;case "center":h(d,function(g,j){f=(e-j[c.anti.out])/2;D(j,c.anti.pos,f)});break;default:h(d,function(g,j){switch(j.nodeName.toLowerCase()){case "button":case "input":case "select":break;default:var l=0;h(c.anti.pad,function(m,r){l+=u(j,r,q);l+=u(a,r,q)});j.style[c.anti.dim]="100%";f=j[c.anti.out]-l;D(j,c.anti.dim,t);f=e;f-=u(j,c.anti.pos,q);h(c.anti.pad,function(m,r){f-=u(j,r,q)});f-=u(j,c.anti.opp,q);f=Math.max(0,f);D(j,c.anti.dim,f)}})}},boxPack:function(a,d,b){var c=this,
e=0,f=0,i=0,g,j,l;l=d.length-1;h(d,function(r,n){e+=n[c.props.out];e+=u(n,c.props.pos,q);e+=u(n,c.props.opp,q)});f=u(d[0],c.props.pos,q);g=a[c.props.out]-e;h(c.props.pad,function(r,n){g-=u(a,n,q)});if(g<0)g=Math.max(0,g);switch(b.pack){case "end":D(d[0],c.props.pos,i+f+g);break;case "center":if(i)i/=2;D(d[0],c.props.pos,i+f+g/2);break;case "justify":f=Math.floor((i+g)/l);l=f*l-g;for(var m=d.length-1;m;){i=d[m];j=f;if(l){j++;l++}j=u(i,c.props.pos,q)+j;D(i,c.props.pos,j);m--}}if((b.pack==="end"||b.pack===
"justify")&&b.orient==="horizontal")pa(a,b,c)}},setup:function(a,d,b){var c=this,e,f;if(!(!a||!d||!b))if(H&&H.partialSupport){e=R(b.children,d,t);f=sa(a);d=O(a,a.childNodes);c.properties.boxOrient.call(c,a,d,b);if(!e.total||!J(b.nested).length){if(b.align==="stretch"&&!H.boxAlignStretch&&(!f.nested||!f.flex))c.properties.boxAlign.call(c,a,d,b);b.pack==="justify"&&!H.boxPackJustify&&!e.total&&c.properties.boxPack.call(c,a,d,b)}}else H||h(c.properties,function(i,g){g.call(c,a,O(a,a.childNodes),b)})},
trackDOM:function(a){Oa(this,a)},updateModel:function(a){var d=a.target,b=a.nodes;ra(b);if(a.flexMatrix||a.ordinalMatrix)a=Ra(a);this.setup(d,b,a);this.bubbleUp(d,a)},renderModel:function(a){var d=this,b=a.target,c=b.childNodes;if(!b.length&&!c)return false;a=Sa(a,this);d.updateModel(a);A.setTimeout(function(){d.trackDOM(a)},0);return d},bubbleUp:function(a,d){for(var b,c=d.target.parentNode;c;){if(b=x[c.FLX_DOM_ID]){ra(b.nodes);this.setup(b.target,b.nodes,b)}c=c.parentNode}}};y.updateInstance=function(a,
d){var b;if(a)if(b=x[a.FLX_DOM_ID])b._instance.updateModel(b);else b=new y.box(d);else h(x,function(c,e){e._instance.updateModel(e)})};y.getInstance=function(a){return x[a.FLX_DOM_ID]};y.destroyInstance=function(a){var d;d=function(b){b.target.FLX_DOM_ID=t;b.target.style.cssText=v;h(b.children,function(c,e){e.match.style.cssText=v})};if(a)(a=x[a.FLX_DOM_ID])&&d(a);else{h(x,function(b,c){d(c)});x=[]}};y.flexboxSupport=function(){var a={},d,b=E.createElement("flxbox"),c;b.style.width=b.style.height=
"100px";b.innerHTML='<b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b>';W(b,"display","box",t);W(b,"box-align","stretch",q);W(b,"box-pack","justify",q);E.body.appendChild(b);d=b.firstChild.offsetHeight;h({boxAlignStretch:function(){return d===100},boxPackJustify:function(){var e=0;h(b.childNodes,function(f,i){e+=i.offsetLeft});
return e===135}},function(e,f){c=f();if(!c)a.partialSupport=q;a[e]=c});E.body.removeChild(b);return~b.style.display.indexOf("box")?a:I};y.init=function(){y.flexboxSupported=H=y.flexboxSupport();J=xa();if((!H||H.partialSupport)&&J)ua()};y.version=0.9;(function(a){var d,b;if((b={DOMAssistant:["*.DOMReady","%"],Prototype:["document.observe","'dom:loaded', %"],YAHOO:["*.util.Event","onDOMReady","%"],MooTools:["window.addEvent","'domready', %"],jQuery:["*(document).ready","%"],dojo:["*.addOnLoad","%"]}[S])&&
!d){if((d=eval(b[0].replace("*",S)))&&b[2])d=d[b[1]];try{eval(d+"("+b[b.length-1].replace("%",a)+")")}catch(c){}}Y("load",function(){!d&&a&&a()})})(y.init);return y}(this,document);
