var Flexie=function(z,C){function D(a){if(a)a=a.replace(ta,w).replace(ua,w);return a}function g(a,d){var c,b=0,e=a?a.length:U;if(e===U)for(c in a){if(a.hasOwnProperty(c))if(d.call(a[c],c,a[c])===H)break}else for(c=a[0];b<e&&d.call(c,b,c)!==H;c=a[++b]);}function va(){var a;g({NW:"*.Dom.select",DOMAssistant:"*.$",Prototype:"$$",YAHOO:"*.util.Selector.query",MooTools:"$$",Sizzle:"*",jQuery:"*",dojo:"*.query"},function(d,c){if(z[d]&&!a)if(a=eval(c.replace("*",d)))Q=d});return a}function V(a,d){a="on"+
a;var c=z[a];z[a]=typeof z[a]!=="function"?d:function(){c&&c();d()}}function W(a){var d=a.nodeName.toLowerCase();if(a.id)d+="#"+a.id;else if(a.FLX_DOM_ID)d+="["+X+"='"+a.FLX_DOM_ID+"']";return d}function R(a){a.FLX_DOM_ID=a.FLX_DOM_ID||++Y;a.setAttribute(X,a.FLX_DOM_ID)}function wa(a){var d=[],c,b,e,f,h,i;a=a.replace(xa,w);a=a.replace(/\s?(\{|\:|\})\s?/g,O);a=a.split(Z);g(a,function(j,l){if(l){c=[l,Z].join(w);if((b=/(.*)\{(.*)\}/.exec(c))&&b[2]){e=b[1];f=b[2].split(";");i=[];g(f,function(n,r){h=r.split(":");
h.length&&h[1]&&i.push({property:h[0],value:h[1]})});e&&i.length&&d.push({selector:e,properties:i})}}});return d}function ya(a){var d,c,b,e,f,h=/\s?,\s?/,i,j,l={},n={};i=function(r,m,o,k){var p={selector:D(r),properties:[]};g(m.properties,function(s,v){p.properties.push({property:D(v.property),value:D(v.value)})});if(o&&k)p[o]=k;return p};j=function(r,m,o,k){var p=o&&k?l[r]:n[r];if(p)g(m.properties,function(s,v){g(p.properties,function(E,K){if(v.property===K.property){p.properties[E]=m.properties[s];
return false}})});else if(o&&k)l[r]=i(r,m,o,k);else n[r]=i(r,m)};g(a,function(r,m){d=D(m.selector).replace(h,",").split(h);g(d,function(o,k){k=D(k);c=m.properties;g(c,function(p,s){b=D(s.property);e=D(s.value);if(b){f=b.replace("box-",w);switch(f){case "display":e==="box"&&j(k,m);break;case "orient":case "align":case "direction":case "pack":j(k,m);break;case "flex":case "flex-group":case "ordinal-group":j(k,m,f,e)}}})})});g(n,function(r,m){x.push(m)});g(l,function(r,m){$.push(m)});return{boxes:x,
children:$}}function aa(a,d,c){var b,e,f=[];g(c,function(h,i){if(i.selector){b=d(i.selector);b[0]&&g(b,function(j,l){switch(l.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(l.parentNode===a){R(l);e={};g(i,function(n){e[n]=i[n]});e.match=l;f.push(e)}}})}else{R(i);f.push({match:i,selector:W(i)})}});return f}function za(a){g(a,function(d,c){a[d]=c||Aa[d]});return a}function Ba(a){var d,c,b,e,f,h,i,j,l,n,r,m,o,k,p={},s,v,E;if(a){g(a.boxes,function(K,u){u.selector=D(u.selector);
d=u.selector;c=u.properties;h=i=j=l=n=A;g(c,function(Ca,F){b=D(F.property);e=D(F.value);if(b){f=b.replace("box-",w);switch(f){case "display":if(e==="box")h=e;break;case "orient":i=e;break;case "align":j=e;break;case "direction":l=e;break;case "pack":n=e}}});r=I;m=r(u.selector);m=m[0]?m:[m];g(m,function(Ca,F){if(F.nodeType){R(F);o=aa(F,r,a.children);E=d+" [data-flexie-parent]";k={target:F,selector:d,properties:c,children:o,display:h,orient:i,align:j,direction:l,pack:n,nested:E};if(s=p[F.FLX_DOM_ID])g(k,
function(J,L){switch(J){case "selector":if(L&&!RegExp(L).test(s[J]))s[J]+=L;break;case "children":g(k[J],function(Ua,ba){v=H;g(s[J],function(Va,Da){if(ba.match.FLX_DOM_ID===Da.match.FLX_DOM_ID)v=q});v||s[J].push(ba)});break;default:if(L)s[J]=L}});else{p[F.FLX_DOM_ID]=za(k);p[F.FLX_DOM_ID].target.setAttribute("data-flexie-parent",q)}}})});ca=I("[data-flexie-parent]");x={};g(ca,function(K,u){x[u.FLX_DOM_ID]=p[u.FLX_DOM_ID]});g(x,function(K,u){u.display==="box"&&new y.box(u)})}}function da(a,d,c){c=
c.replace(c.charAt(0),c.charAt(0).toUpperCase());var b=a["offset"+c]||0;b&&g(d,function(e,f){f=parseFloat(a.currentStyle[f]);isNaN(f)||(b-=f)});return b}function ea(a,d){var c,b,e=a.currentStyle&&a.currentStyle[d],f=a.style;if(!fa.test(e)&&Ea.test(e)){c=f.left;b=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;f.left=e||0;e=f.pixelLeft+"px";f.left=c||0;a.runtimeStyle.left=b}return e}function t(a,d,c){if(z.getComputedStyle)a=z.getComputedStyle(a,A)[d];else{if(Fa.test(d)){var b=a&&a.currentStyle?
a.currentStyle[d]:0;if(!fa.test(b)){if(b==="auto"||b==="medium"){b=b;switch(d){case "width":b=[ga,ha,ia,ja];b=da(a,b,d);break;case "height":b=[S,ka,la,ma];b=da(a,b,d);break;default:b=ea(a,d)}a=b}else a=ea(a,d);b=a}a=b}else a=a.currentStyle[d];a=a}a=a;if(c){a=parseInt(a,10);if(isNaN(a))a=0}return a}function Ga(a){return a.innerWidth||a.clientWidth}function Ha(a){return a.innerHeight||a.clientHeight}function T(a,d,c,b){var e=[];g(Ia,function(f,h){e.push((b?h:w)+d+":"+(!b?h:w)+c)});a.style.cssText+=
e.join(";");return a}function B(a,d,c){g(a&&a[0]?a:[a],function(b,e){if(e&&e.style)e.style[d]=c?c+"px":w})}function Ja(a,d){var c,b,e;c=a.replace(Ka,function(f,h){return"%"+h}).replace(/\s|\>|\+|\~/g,"%").split(/%/g);b={_id:100,_class:10,_tag:1};e=d||0;g(c,function(f,h){if(/#/.test(h))e+=b._id;else if(/\.|\[|\:/.test(h))e+=b._class;else if(/[a-zA-Z]+/.test(h))e+=b._tag});return e}function La(a,d,c){var b=[],e,f=(c?"ordinal":"flex")+"Specificity";g(a,function(h,i){if(!c&&i.flex||c&&i["ordinal-group"]){i[f]=
i[f]||Ja(i.selector);e=H;g(b,function(j,l){if(l.match===i.match){if(l[f]<i[f])b[j]=i;e=q;return H}});e||b.push(i)}});return b}function P(a,d,c){var b={},e=[],f=0,h;a=La(a,d,c);g(d,function(i,j){g(a,function(l,n){if(c){h=n["ordinal-group"]||"1";if(n.match===j){n.match.setAttribute("data-ordinal-group",h);b[h]=b[h]||[];b[h].push(n)}}else{h=n.flex||"0";if(n.match===j&&(!n[h]||n[h]&&parseInt(n[h],10)<=1)){f+=parseInt(h,10);b[h]=b[h]||[];b[h].push(n)}}});if(c&&!j.getAttribute("data-ordinal-group")){h=
"1";j.setAttribute("data-ordinal-group",h);b[h]=b[h]||[];b[h].push({match:j})}});g(b,function(i){e.push(i)});e.sort(function(i,j){return j-i});return{keys:e,groups:b,total:f}}function na(a,d,c){a=d.nodes;var b;for(b=function(e){return e.offsetTop-t(e,c.anti.pos,q)};b(a[0])!==b(a[a.length-1]);)g(a,function(e,f){if(!d.hasFlex||f.getAttribute("data-flex"))f.style[c.props.dim]=t(f,c.props.dim,q)-1})}function Ma(){if(!oa){var a,d,c,b,e=C.body,f=C.documentElement;V("resize",function(){c=z.innerWidth||f.innerWidth||
f.clientWidth||e.clientWidth;b=z.innerHeight||f.innerHeight||f.clientHeight||e.clientHeight;if(a!==c||d!==b){y.updateInstance();a=c;d=b}});oa=q}}function pa(a){var d,c;g(a,function(b,e){d=e.style.width;c=e.style.height;e.style.cssText=w;e.style.width=d;e.style.height=c})}function M(a,d){var c=[],b,e,f;e=0;for(f=d.length;e<f;e++)if(b=d[e])switch(b.nodeName.toLowerCase()){case "script":case "style":case "link":break;default:if(b.nodeType===1)c.push(b);else if(b.nodeType===3&&(b.isElementContentWhitespace||
Na.test(b.data))){a.removeChild(b);e--}}return c}function qa(a){var d=0;a=a.parentNode;for(var c;a.FLX_DOM_ID;){c=x[a.FLX_DOM_ID];c=P(c.children,M(a,a.childNodes));d+=c.total;c=q;a=a.parentNode}return{nested:c,flex:d}}function Oa(a,d){var c=a.parentNode,b;if(c.FLX_DOM_ID){c=x[c.FLX_DOM_ID];g(c.properties,function(e,f){if(RegExp(d).test(f.property)){b=q;return H}})}return b}function Pa(a){a.flexMatrix&&g(a.children,function(d,c){c.flex=a.flexMatrix[d]});a.ordinalMatrix&&g(a.children,function(d,c){c["ordinal-group"]=
a.ordinalMatrix[d]});return a}function Qa(a,d){var c=a.target;if(!c.FLX_DOM_ID)c.FLX_DOM_ID=c.FLX_DOM_ID||++Y;if(!a.nodes)a.nodes=M(c,c.childNodes);if(!a.selector){a.selector=W(c);c.setAttribute("data-flexie-parent",q)}if(!a.properties)a.properties=[];if(!a.children)a.children=aa(c,I,M(c,c.childNodes));if(!a.nested)a.nested=a.selector+" [data-flexie-parent]";a.target=c;a._instance=d;return a}var y={},Y=0,X="data-flexie-id",G,Q,I,fa=/^-?\d+(?:px)?$/i,Ea=/^-?\d/,Fa=/width|height|margin|padding|border/,
Ra=/(msie) ([\w.]+)/,xa=/\t|\n|\r/g,Sa=/^max\-([a-z]+)/,Ta=/^https?:\/\//i,ta=/^\s\s*/,ua=/\s\s*$/,Na=/^\s*$/,Ka=/\s?(\#|\.|\[|\:(\:)?[^first\-(line|letter)|before|after]+)/g,w="",ra=" ",O="$1",ha="paddingRight",ka="paddingBottom",ga="paddingLeft",S="paddingTop",ja="borderRightWidth",ma="borderBottomWidth",ia="borderLeftWidth",la="borderTopWidth",Z="}",Ia=" -o- -moz- -ms- -webkit- -khtml- ".split(ra),Aa={orient:"horizontal",align:"stretch",direction:"inherit",pack:"start"},x=[],$=[],ca,oa,q=true,
H=false,A=null,U,N={IE:function(){var a,d=Ra.exec(z.navigator.userAgent.toLowerCase());if(d)a=parseInt(d[2],10);return a}()},sa;sa=function(){function a(o){return o.replace(j,function(k,p,s){k=s.split(",");g(k,function(v,E){E.replace(l,O).replace(n,O).replace(m,O).replace(r,ra)});return p+k.join(",")})}function d(){if(z.XMLHttpRequest)return new z.XMLHttpRequest;try{return new z.ActiveXObject("Microsoft.XMLHTTP")}catch(o){return A}}function c(o){var k=d();k.open("GET",o,H);k.send();return k.status===
200?k.responseText:w}function b(o,k){if(o){if(Ta.test(o))return k.substring(0,k.indexOf("/",8))===o.substring(0,o.indexOf("/",8))?o:A;if(o.charAt(0)==="/")return k.substring(0,k.indexOf("/",8))+o;var p=k.split("?")[0];if(o.charAt(0)!=="?"&&p.charAt(p.length-1)!=="/")p=p.substring(0,p.lastIndexOf("/")+1);return p+o}}function e(o){if(o)return c(o).replace(f,w).replace(h,function(k,p,s){return e(b(s,o))}).replace(i,function(k,p,s){p=p||w;return" url("+p+b(s,o)+p+") "});return w}var f=/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)\s*/g,
h=/@import\s*(?:url\(\s*?)?(["'])?(.*?)\1\s*\)?[\w\W]*?;/g,i=/\surl\((["'])?([^"')]+)\1\)/g,j=/(^|\})\s*([^\{]*?[\[:][^\{]+)/g,l=/([(\[+~])\s+/g,n=/\s+([)\]+~])/g,r=/\s+/g,m=/^\s*((?:[\S\s]*\S)?)\s*$/;return function(){var o,k,p;k=C.getElementsByTagName("BASE");var s=k.length>0?k[0].href:C.location.href,v;k=0;for(p=C.styleSheets.length;k<p;k++)if((o=C.styleSheets[k])&&o.href!==A)if(o=b(o.href,s)){v=a(e(o));v=wa(v);v=ya(v)}Ba(v)}}();y.box=function(a){this.renderModel(a)};y.box.prototype={properties:{boxModel:function(a,
d,c){var b,e;a.style.display="block";if(!c.cleared){d=c.selector;b=C.styleSheets;b=b[b.length-1];e="padding-top:"+(t(a,S,A)||"0.1px;");if(b.addRule)if(N.IE<8){a.style.zoom="1";if(N.IE===6)b.addRule(d.replace(/\>|\+|\~/g,""),e+"zoom:1;",0);else N.IE===7&&b.addRule(d,e+"display:inline-block;",0)}else b.addRule(d+":after","content:' ';display:block;margin:0;padding:0;border:0;height:0;background:none;clear:both;font-size:0;visibility:hidden",0);else if(b.insertRule){b.insertRule(d+"{"+e+"}",0);b.insertRule(d+
":after{content:' ';display:block;margin:0;padding:0;border:0;height:0;background:none;clear:both;font-size:0;visibility:hidden}",0)}c.cleared=q}},boxDirection:function(a,d,c){var b;if(c.direction==="reverse"&&!c.reversed||c.direction==="normal"&&c.reversed){d=d.reverse();g(d,function(e,f){a.appendChild(f)});d=I(c.nested);g(d,function(e,f){if((b=x[f.FLX_DOM_ID])&&b.direction==="inherit")b.direction=c.direction});c.reversed=!c.reversed}},boxOrient:function(a,d,c){var b;a={pos:"marginLeft",opp:"marginRight",
dim:"width",out:"offsetWidth",func:Ga,pad:[ga,ha,ia,ja]};b={pos:"marginTop",opp:"marginBottom",dim:"height",out:"offsetHeight",func:Ha,pad:[S,ka,la,ma]};G||g(d,function(e,f){f.style[N.IE>=9?"cssFloat":"styleFloat"]="left";if(c.orient==="vertical")f.style.clear="left";if(N.IE===6)f.style.display="inline"});switch(c.orient){case "vertical":case "block-axis":this.props=b;this.anti=a;break;default:this.props=a;this.anti=b}},boxOrdinalGroup:function(a,d,c){var b,e;if(d.length){b=function(f){f=f.keys;g(c.reversed?
f:f.reverse(),function(h,i){g(d,function(j,l){i===l.getAttribute("data-ordinal-group")&&a.appendChild(l)})})};e=P(c.children,d,q);e.keys.length>1&&b(e)}},boxFlex:function(a,d,c){var b=this,e,f,h,i;if(d.length){e=function(j){var l=j.groups,n;g(j.keys,function(r,m){g(l[m],function(o,k){n=A;g(k.properties,function(p,s){if(Sa.test(s.property))n=parseFloat(s.value)});if(!n||k.match[b.props.out]>n)B(k.match,b.props.pos,A)})})};f=function(j){var l=0,n;g(d,function(r,m){l+=t(m,b.props.dim,q);g(b.props.pad,
function(o,k){l+=t(m,k,q)});l+=t(m,b.props.pos,q);l+=t(m,b.props.opp,q)});n=a[b.props.out]-l;g(b.props.pad,function(r,m){n-=t(a,m,q)});return{whitespace:n,ration:n/j.total}};h=function(j,l){var n=j.groups,r,m,o=l.ration,k,p,s;g(j.keys,function(v,E){k=o*E;g(n[E],function(K,u){if(u.match){r=u.match.getAttribute("data-flex");m=u.match.getAttribute("data-specificity");if(!r||m<=u.flexSpecificity){u.match.setAttribute("data-flex",E);u.match.setAttribute("data-specificity",u.flexSpecificity);p=t(u.match,
b.props.dim,q);if(c.orient==="horizontal"){p+=t(a,b.props.pos,q);p+=t(a,b.props.opp,q)}s=Math.max(0,p+k);B(u.match,b.props.dim,s)}}})});c.orient==="horizontal"&&na(a,c,b)};i=P(c.children,d);if(i.total){c.hasFlex=true;e(i);e=f(i);h(i,e)}}},boxAlign:function(a,d,c){var b=this,e,f,h=qa(a);if(!G&&!h.flex){Oa(a,b.anti.dim)||B(a,b.anti.dim,A);B(d,b.anti.dim,A)}e=a[b.anti.out];g(b.anti.pad,function(i,j){e-=t(a,j,q)});switch(c.align){case "start":break;case "end":g(d,function(i,j){f=e-j[b.anti.out];f-=t(j,
b.anti.opp,q);B(j,b.anti.pos,f)});break;case "center":g(d,function(i,j){f=(e-j[b.anti.out])/2;B(j,b.anti.pos,f)});break;default:g(d,function(i,j){switch(j.nodeName.toLowerCase()){case "button":case "input":case "select":break;default:var l=0;g(b.anti.pad,function(n,r){l+=t(j,r,q);l+=t(a,r,q)});j.style[b.anti.dim]="100%";f=j[b.anti.out]-l;B(j,b.anti.dim,A);f=e;f-=t(j,b.anti.pos,q);g(b.anti.pad,function(n,r){f-=t(j,r,q)});f-=t(j,b.anti.opp,q);f=Math.max(0,f);B(j,b.anti.dim,f)}})}},boxPack:function(a,
d,c){var b=this,e=0,f=0,h=0,i,j,l;l=d.length-1;g(d,function(r,m){e+=m[b.props.out];e+=t(m,b.props.pos,q);e+=t(m,b.props.opp,q)});f=t(d[0],b.props.pos,q);i=a[b.props.out]-e;g(b.props.pad,function(r,m){i-=t(a,m,q)});if(i<0)i=Math.max(0,i);switch(c.pack){case "end":B(d[0],b.props.pos,h+f+i);break;case "center":if(h)h/=2;B(d[0],b.props.pos,h+f+i/2);break;case "justify":f=Math.floor((h+i)/l);l=f*l-i;for(var n=d.length-1;n;){h=d[n];j=f;if(l){j++;l++}j=t(h,b.props.pos,q)+j;B(h,b.props.pos,j);n--}}if((c.pack===
"end"||c.pack==="justify")&&c.orient==="horizontal")na(a,c,b)}},setup:function(a,d,c){var b=this,e,f;if(!(!a||!d||!c))if(G&&G.partialSupport){e=P(c.children,d);f=qa(a);d=M(a,a.childNodes);b.properties.boxOrient.call(b,a,d,c);if((!e.total||!I(c.nested).length)&&(!f.nested||!f.flex)){c.align==="stretch"&&!G.boxAlignStretch&&b.properties.boxAlign.call(b,a,d,c);c.pack==="justify"&&!G.boxPackJustify&&b.properties.boxPack.call(b,a,d,c)}}else G||g(b.properties,function(h,i){i.call(b,a,M(a,a.childNodes),
c)})},trackDOM:function(a){Ma(this,a)},updateModel:function(a){var d=a.target,c=a.nodes;pa(c);if(a.flexMatrix||a.ordinalMatrix)a=Pa(a);this.setup(d,c,a);this.bubbleUp(d,a)},renderModel:function(a){var d=this,c=a.target,b=c.childNodes;if(c.length||b){a=Qa(a,this);d.updateModel(a);z.setTimeout(function(){d.trackDOM(a)},0)}},bubbleUp:function(a,d){for(var c,b=d.target.parentNode;b;){if(c=x[b.FLX_DOM_ID]){pa(c.nodes);this.setup(c.target,c.nodes,c)}b=b.parentNode}}};y.updateInstance=function(a,d){var c;
if(a)if(c=x[a.FLX_DOM_ID])c._instance.updateModel(c);else c=new y.box(d);else g(x,function(b,e){e._instance.updateModel(e)})};y.getInstance=function(a){return x[a.FLX_DOM_ID]};y.destroyInstance=function(a){var d;d=function(c){c.target.FLX_DOM_ID=A;c.target.style.cssText=w;g(c.children,function(b,e){e.match.style.cssText=w})};if(a)(a=x[a.FLX_DOM_ID])&&d(a);else{g(x,function(c,b){d(b)});x=[]}};y.flexboxSupport=function(){var a={},d,c=C.createElement("flxbox"),b;c.style.width=c.style.height="100px";
c.innerHTML='<b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b><b style="margin: 0; padding: 0; display:block; width: 10px; height:50px"></b>';T(c,"display","box");T(c,"box-align","stretch",q);T(c,"box-pack","justify",q);C.body.appendChild(c);d=c.firstChild.offsetHeight;g({boxAlignStretch:function(){return d===100},boxPackJustify:function(){var e=0;g(c.childNodes,function(f,h){e+=h.offsetLeft});
return e===135}},function(e,f){b=f();if(!b)a.partialSupport=q;a[e]=b});C.body.removeChild(c);return~c.style.display.indexOf("box")?a:H};y.init=function(){y.flexboxSupported=G=y.flexboxSupport();I=va();if((!G||G.partialSupport)&&I)sa()};y.version=0.9;(function(a){var d,c;if((c={DOMAssistant:["*.DOMReady","%"],Prototype:["document.observe","'dom:loaded', %"],YAHOO:["*.util.Event","onDOMReady","%"],MooTools:["window.addEvent","'domready', %"],jQuery:["*(document).ready","%"],dojo:["*.addOnLoad","%"]}[Q])&&
!d){if((d=eval(c[0].replace("*",Q)))&&c[2])d=d[c[1]];try{eval(d+"("+c[c.length-1].replace("%",a)+")")}catch(b){}}V("load",function(){!d&&a&&a()})})(y.init);return y}(this,document);
